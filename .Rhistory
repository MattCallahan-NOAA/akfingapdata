library(akfingapdata)
hello()
get_gap_biomass<-function(area_id, species_code) {
# paste(... collapse=",") puts commas between vector elements
area_id <- paste(area_id, collapse = ",")
species_code <- paste(species_code, collapse = ",")
query <- list(area_id, species_code)
url <- "https://apex.psmfc.org/akfin/data_marts/akmp/gap_biomass?"
httr::content(
httr::GET(url=url, query=query)),
get_gap_biomass<-function(area_id, species_code) {
# paste(... collapse=",") puts commas between vector elements
area_id <- paste(area_id, collapse = ",")
species_code <- paste(species_code, collapse = ",")
query <- list(area_id, species_code)
url <- "https://apex.psmfc.org/akfin/data_marts/akmp/gap_biomass?"
httr::content(
httr::GET(url=url, query=query),
type = "application/json") %>%
# convert to data frame
dplyr::bind_rows() %>%
dplyr::rename_with(tolower)
}
#test
lc<-get_gap_biomass(area_id=40, species_code=21910)
#test
library(magrittr)
lc<-get_gap_biomass(area_id=40, species_code=21910)
get_gap_biomass<-function(area_id, species_code) {
# paste(... collapse=",") puts commas between vector elements
#area_id <- paste(area_id, collapse = ",")
#species_code <- paste(species_code, collapse = ",")
query <- list(area_id, species_code)
url <- "https://apex.psmfc.org/akfin/data_marts/akmp/gap_biomass?"
httr::content(
httr::GET(url=url, query=query),
type = "application/json") %>%
# convert to data frame
dplyr::bind_rows() %>%
dplyr::rename_with(tolower)
}
lc<-get_gap_biomass(area_id=40, species_code=21910)
get_gap_biomass<-function(area_id, species_code) {
# paste(... collapse=",") puts commas between vector elements
area_id <- paste(area_id, collapse = ",")
species_code <- paste(species_code, collapse = ",")
# httr code, parameters are after the '?'
httr::content(
httr::GET(paste0("https://apex.psmfc.org/akfin/data_marts/akmp/gap_biomass?area_id=",
area_id,
"&species_code=",
species_code)),
type = "application/json") %>%
# convert to data frame
bind_rows()
}
lc<-get_gap_biomass(area_id=40, species_code=21910)
get_gap_biomass<-function(area_id, species_code) {
# paste(... collapse=",") puts commas between vector elements
area_id <- paste(area_id, collapse = ",")
species_code <- paste(species_code, collapse = ",")
# httr code, parameters are after the '?'
httr::content(
httr::GET(paste0("https://apex.psmfc.org/akfin/data_marts/akmp/gap_biomass?area_id=",
area_id,
"&species_code=",
species_code)),
type = "application/json") %>%
# convert to data frame
dplyr::bind_rows()%>%
dplyr::rename_with(tolower)
}
#test
#library(magrittr)
lc<-get_gap_biomass(area_id=40, species_code=21910)
get_gap_biomass<-function(area_id, species_code) {
# paste(... collapse=",") puts commas between vector elements
#area_id <- paste(area_id, collapse = ",")
#species_code <- paste(species_code, collapse = ",")
query <- list(area_id=area_id, species_code=species_code)
url <- "https://apex.psmfc.org/akfin/data_marts/akmp/gap_biomass?"
httr::content(
httr::GET(url=url, query=query),
type = "application/json") %>%
# convert to data frame
dplyr::bind_rows() %>%
dplyr::rename_with(tolower)
}
#test
#library(magrittr)
lc<-get_gap_biomass(area_id=40, species_code=21910)
#test
#library(magrittr)
lc<-get_gap_biomass(area_id=c(40, 41), species_code=21910)
get_gap_biomass<-function(area_id, species_code) {
# paste(... collapse=",") puts commas between vector elements
area_id <- paste(area_id, collapse = ",")
species_code <- paste(species_code, collapse = ",")
query <- list(area_id=area_id, species_code=species_code)
url <- "https://apex.psmfc.org/akfin/data_marts/akmp/gap_biomass?"
httr::content(
httr::GET(url=url, query=query),
type = "application/json") %>%
# convert to data frame
dplyr::bind_rows() %>%
dplyr::rename_with(tolower)
}
#test
#library(magrittr)
lc<-get_gap_biomass(area_id=c(40, 41), species_code=21910)
get_gap_biomass<-function(area_id=40, species_code=21010) {
# paste(... collapse=",") puts commas between vector elements
area_id <- paste(area_id, collapse = ",")
species_code <- paste(species_code, collapse = ",")
query <- list(area_id=area_id, species_code=species_code)
url <- "https://apex.psmfc.org/akfin/data_marts/akmp/gap_biomass?"
httr::content(
httr::GET(url=url, query=query),
type = "application/json") %>%
# convert to data frame
dplyr::bind_rows() %>%
dplyr::rename_with(tolower)
}
#test
#library(magrittr)
lc<-get_gap_biomass()
lc<-get_gap_biomass(area_id=c(40, 41), species_code=21910)
library(httr)
library(dplyr)
start<- Sys.time()
data_fx<-get_gap_biomass()
end<-Sys.time()
fx_time<-end-start
fx_time
start<- Sys.time()
data2<-httr::content(
httr::GET(paste0("https://apex.psmfc.org/akfin/data_marts/akmp/gap_biomass?area_id=40&species_code=21010")),
type = "application/json")
end<-Sys.time()
httr_time<-end-start
httr_time
get_gap_biomass<-function(area_id=40, species_code=21010, start_year=1990, end_year=3000) {
# paste(... collapse=",") puts commas between vector elements
area_id <- paste(area_id, collapse = ",")
species_code <- paste(species_code, collapse = ",")
query <- list(area_id=area_id, species_code=species_code, start_year=start_year, end_year=end_year)
url <- "https://apex.psmfc.org/akfin/data_marts/akmp/gap_biomass?"
httr::content(
httr::GET(url=url, query=query),
type = "application/json") %>%
# convert to data frame
dplyr::bind_rows() %>%
dplyr::rename_with(tolower)
}
start<-Sys.time()
lc<-get_gap_biomass()
end<-Sys.time()
end-start
start<-Sys.time()
lc<-get_gap_biomass(start_year=1975)
end<-Sys.time()
end-start
library(akfingapdata)
start<-Sys.time()
lc<-get_gap_biomass(start_year=1975)
end<-Sys.time()
end-start
library(akfingapdata)
area<-get_gap_area()
libraRY(magrittr)
library(magrittr)
area<-get_gap_area()
View(area)
library(akfingapdata)
library(magrittr)
species<-get_gap_species()
library(akfingapdata)
library(magrittr)
species<-get_gap_spcies()
species<-get_gap_species()
get_gap_species<-function() {
url <- "https://apex.psmfc.org/akfin/data_marts/akmp/gap_species_code?"
httr::content(
httr::GET(url=url),
type = "application/json") %>%
# convert to data frame
dplyr::bind_rows() %>%
dplyr::rename_with(tolower)
}
species<-get_gap_species_code()
species<-get_gap_species()
url <- "https://apex.psmfc.org/akfin/data_marts/akmp/gap_taxonmics?"
get_gap_species<-function() {
url <- "https://apex.psmfc.org/akfin/data_marts/akmp/gap_taxonmics?"
httr::content(
httr::GET(url=url),
type = "application/json") %>%
# convert to data frame
dplyr::bind_rows() %>%
dplyr::rename_with(tolower)
}
species<-get_gap_species()
get_gap_species<-function() {
url <- "https://apex.psmfc.org/akfin/data_marts/akmp/gap_taxonomics?"
httr::content(
httr::GET(url=url),
type = "application/json") %>%
# convert to data frame
dplyr::bind_rows() %>%
dplyr::rename_with(tolower)
}
species<-get_gap_species()
library(akfingapdata)
27000/2080
27000/11/52
#test
library(akfingapdata)
library(magrittr)
library(dplyr)
library(httr)
# compare central AI pcod to akfin answers
species<-get_gap_species()
species$common_name %>% arrange()
species$common_name %>% sort()
species%>%filter(common_name %in% ("Pacific cod",
species%>%filter(common_name %in% c("Pacific cod",
"Pacific cod (adult)",
"Pacific cod (juvenile)"))
#find area codes
area<-get_gap_area()
sort(area$area_name)
area %>% filter(area_name=="Central Aleutians")
area %>% filter(area_name=="Central Aleutians")%>%
print(ncol=Inf)
area %>% filter(area_name=="Central Aleutians")%>%
print(ncol=Inf)
species%>%filter(common_name %in% c("Pacific cod",
"Pacific cod (adult)",
"Pacific cod (juvenile)"))
ai_pcod_2022_biom<-get_gap_biomass(area_id=3499,
species_code=c(21720,21721,21722))
View(ai_pcod_2022_biom)
ai_pcod_2022_biom<-get_gap_biomass(area_id=3499,
species_code=c(21720,21721,21722),
start_year=2022, end_year=2022)
View(ai_pcod_2022_biom)
write.csv(ai_pcod_2022_biom, "ai_pcod_2022_biom.csv",row.names = FALSE)
#what about NMFS541 vs CAI
area %>% filter(area_name=="541")%>%
print(ncol=Inf)
View(area)
#what about NMFS541 vs CAI
area %>% filter(survey_definition_d==52)%>%
print(ncol=Inf)
#what about NMFS541 vs CAI
area %>% filter(survey_definition_id==52)%>%
print(ncol=Inf)
#what about NMFS541 vs CAI
area %>% filter(survey_definition_id==52)%>%
print(n=Inf)
species%>%filter(common_name %contains% "pollock")
species%>%filter(contains(common_name,  "pollock"))
species%>%filter(common_name==contains("pollock"))
#Let's try EBS pollock
species%>%filter(grepl("pollock", common_name))
area %>% filter(area_name=="1")
area %>% filter(area_name=="10")
View(area)
area %>% filter(area_name=="1.0")
area %>% filter(area_name=="1.0")
area %>% filter(area_name=="1.0")%>%
print(n=Inf)
#Let's try EBS pollock
species %>% filter(grepl("pollock", common_name))
ebs_s1_pollock_2022_biom<-get_gap_biomass(area_id=1,
species_code=21740,
start_year=2022, end_year=2022)
View(ebs_s1_pollock_2022_biom)
write.csv(ebs_s1_pollock_2022_biom, "ebs_s1_pollock_2022_biom.csv",row.names = FALSE)
ebs_s1_pollock_2022_biom<-get_gap_biomass(area_id=1,
species_code=21740,
start_year=2023, end_year=2023)
write.csv(ebs_s1_pollock_2022_biom, "ebs_s1_pollock_2022_biom.csv",row.names = FALSE)
ebs_s1_pollock_2022_biom<-get_gap_biomass(area_id=1,
species_code=21740,
start_year=2022, end_year=2022)
ebs_s1_pollock_2022_biom<-get_gap_biomass(area_id=1,
species_code=21740,
start_year=2022, end_year=2023)
ebs_s1_pollock_2022_biom<-get_gap_biomass(area_id=1,
species_code=21740,
start_year=2022, end_year=2022)
write.csv(ebs_s1_pollock_2022_biom, "ebs_s1_pollock_2022_biom.csv",row.names = FALSE)
?get_gap_biomass
library(akfingapdata)
library(akfinapi)
?get_basis_catch
library(akfingapdata)
