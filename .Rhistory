add_headers(Authorization = token)),
type = "application/json") %>%
# convert to data frame
dplyr::bind_rows() %>%
dplyr::rename_with(tolower)
}
Start<-Sys.time()
test<-get_gap_cpue(species_code=c(21740,21050))
End<-Sys.time()
End-Start
unique(test$species_code)
worms<-get_gap_taxomics()
create_token<-function(file) {
# Secret string text file needs to be in your working R directory
secret <- jsonlite::base64_enc( readChar(file,nchars=1e6) )
# Get token from API
req <- httr::POST("https://apex.psmfc.org/akfin/data_marts/oauth/token",
httr::add_headers(
"Authorization" = paste("Basic", gsub("\n", "", secret)),
"Content-Type" = "application/x-www-form-urlencoded;charset=UTF-8"
),
body = "grant_type=client_credentials");
#  Create authentication error message
httr::stop_for_status(req, "Something broke.")
paste("Bearer", httr::content(req)$access_token)
}
token<-create_token("Callahan_token.txt")
get_gap_cpue<-function(species_code) {
# # Secret string text file needs to be in your working R directory
# secret <- jsonlite::base64_enc( readChar("Callahan_token.txt",nchars=1e6) )
#
# # Get token from API
# req <- httr::POST("https://apex.psmfc.org/akfin/data_marts/oauth/token",
#                   httr::add_headers(
#                     "Authorization" = paste("Basic", gsub("\n", "", secret)),
#                     "Content-Type" = "application/x-www-form-urlencoded;charset=UTF-8"
#                   ),
#                   body = "grant_type=client_credentials");
#
# #  Create authentication error message
# httr::stop_for_status(req, "Something broke.")
# token <- paste("Bearer", httr::content(req)$access_token)
url <- "https://apex.psmfc.org/akfin/data_marts/gap_products/gap_cpue?"
species_code <- paste(species_code, collapse = ",")
query <- list(species_code=species_code)
httr::content(
httr::GET(url=url, query,
add_headers(Authorization = token)),
type = "application/json") %>%
# convert to data frame
dplyr::bind_rows() %>%
dplyr::rename_with(tolower)
}
Start<-Sys.time()
test<-get_gap_cpue(species_code=c(21740,21520))
End<-Sys.time()
End-Start
get_gap_biomass<-function(survey_definition_id=98, area_id=1, species_code=21740, start_year=1990, end_year=3000) {
# paste(... collapse=",") puts commas between vector elements
area_id <- paste(area_id, collapse = ",")
species_code <- paste(species_code, collapse = ",")
survey_definition_id<-paste(survey_definition_id, collapse = ",")
query <- list(survey_definition_id<-survey_definition_id, area_id=area_id, species_code=species_code, start_year=start_year, end_year=end_year)
url <- "https://apex.psmfc.org/akfin/data_marts/gap_products/gap_agecomp?"
httr::content(
httr::GET(url=url, query=query,
add_headers(Authorization = token)),
type = "application/json") %>%
# convert to data frame
dplyr::bind_rows() %>%
dplyr::rename_with(tolower)
}
Start<-Sys.time()
test<-get_gap_agecomp()
get_gap_agecomp<-function(survey_definition_id=98, area_id=1, species_code=21740, start_year=1990, end_year=3000) {
# paste(... collapse=",") puts commas between vector elements
area_id <- paste(area_id, collapse = ",")
species_code <- paste(species_code, collapse = ",")
survey_definition_id<-paste(survey_definition_id, collapse = ",")
query <- list(survey_definition_id<-survey_definition_id, area_id=area_id, species_code=species_code, start_year=start_year, end_year=end_year)
url <- "https://apex.psmfc.org/akfin/data_marts/gap_products/gap_agecomp?"
httr::content(
httr::GET(url=url, query=query,
add_headers(Authorization = token)),
type = "application/json") %>%
# convert to data frame
dplyr::bind_rows() %>%
dplyr::rename_with(tolower)
}
# 4.4 minutes
Start<-Sys.time()
test<-get_gap_agecomp()
End<-Sys.time()
End-Start
#
token<-create_token()
token<-create_token("Callahan+token.txt")
token<-create_token("Callahan_token.txt")
Start<-Sys.time()
test<-get_gap_agecomp()
End<-Sys.time()
End-Start
url <- "https://apex.psmfc.org/akfin/data_marts/gap_products/gap_agecomp?"
httr::content(
httr::GET(url=url, #query=query,
add_headers(Authorization = token)),
type = "application/json") %>%
# convert to data frame
dplyr::bind_rows() %>%
dplyr::rename_with(tolower)
get_gap_agecomp<-function(survey_definition_id=98, area_id=10, species_code=21740, start_year=1990, end_year=3000) {
# paste(... collapse=",") puts commas between vector elements
area_id <- paste(area_id, collapse = ",")
species_code <- paste(species_code, collapse = ",")
survey_definition_id<-paste(survey_definition_id, collapse = ",")
query <- list(survey_definition_id<-survey_definition_id, area_id=area_id, species_code=species_code, start_year=start_year, end_year=end_year)
url <- "https://apex.psmfc.org/akfin/data_marts/gap_products/gap_agecomp?"
httr::content(
httr::GET(url=url, #query=query,
add_headers(Authorization = token)),
type = "application/json") %>%
# convert to data frame
dplyr::bind_rows() %>%
dplyr::rename_with(tolower)
}
Start<-Sys.time()
test<-get_gap_agecomp()
End<-Sys.time()
End-Start
get_gap_cruises<-function(survey_definition_id=98, start_year=1990, end_year=3000) {
# paste(... collapse=",") puts commas between vector elements
survey_definition_id<-paste(survey_definition_id, collapse = ",")
query <- list(survey_definition_id=survey_definition_id, start_year=start_year, end_year=end_year)
url <- "https://apex.psmfc.org/akfin/data_marts/gap_products/gap_agecomp?"
httr::content(
httr::GET(url=url, #query=query,
add_headers(Authorization = token)),
type = "application/json") %>%
# convert to data frame
dplyr::bind_rows() %>%
dplyr::rename_with(tolower)
}
Start<-Sys.time()
test<-get_gap_cruises()
End<-Sys.time()
End-Start
get_gap_cruises<-function(survey_definition_id=98, start_year=1990, end_year=3000) {
# paste(... collapse=",") puts commas between vector elements
survey_definition_id<-paste(survey_definition_id, collapse = ",")
query <- list(survey_definition_id=survey_definition_id, start_year=start_year, end_year=end_year)
url <- "https://apex.psmfc.org/akfin/data_marts/gap_products/gap_cruises?"
httr::content(
httr::GET(url=url, #query=query,
add_headers(Authorization = token)),
type = "application/json") %>%
# convert to data frame
dplyr::bind_rows() %>%
dplyr::rename_with(tolower)
}
Start<-Sys.time()
test<-get_gap_cruises()
End<-Sys.time()
End-Start
Start<-Sys.time()
test<-get_gap_haul()
get_gap_haul<-function() {
url <- "https://apex.psmfc.org/akfin/data_marts/gap_products/gap_haul?"
httr::content(
httr::GET(url=url,
add_headers(Authorization = token)),
type = "application/json") %>%
# convert to data frame
dplyr::bind_rows() %>%
dplyr::rename_with(tolower)
}
Start<-Sys.time()
test<-get_gap_haul()
Start<-Sys.time()
test<-get_gap_haul()
End<-Sys.time()
End-Start
get_gap_lengths<-function(species_code=21740) {
# paste(... collapse=",") puts commas between vector elements
species_code <- paste(species_code, collapse = ",")
query <- list(species_code=species_code)
url <- "https://apex.psmfc.org/akfin/data_marts/gap_products/gap_lengths?"
httr::content(
httr::GET(url=url, #query=query,
add_headers(Authorization = token)),
type = "application/json") %>%
# convert to data frame
dplyr::bind_rows() %>%
dplyr::rename_with(tolower)
}
Start<-Sys.time()
test<-get_gap_lengths()
Start<-Sys.time()
test<- httr::content(
httr::GET(url="https://apex.psmfc.org/akfin/data_marts/gap_products/gap_lengths?species_code=21470"
add_headers(Authorization = token)),
Start<-Sys.time()
test<- httr::content(
httr::GET(url="https://apex.psmfc.org/akfin/data_marts/gap_products/gap_lengths?species_code=21470",
add_headers(Authorization = token)),
type = "application/json") %>%
# convert to data frame
dplyr::bind_rows() %>%
dplyr::rename_with(tolower)
End<-Sys.time()
End-Start
Start<-Sys.time()
test<-get_gap_sizecomp()
get_gap_sizecomp<-function(survey_definition_id=98, area_id=1, species_code=21740, start_year=1990, end_year=3000) {
# paste(... collapse=",") puts commas between vector elements
area_id <- paste(area_id, collapse = ",")
species_code <- paste(species_code, collapse = ",")
survey_definition_id<-paste(survey_definition_id, collapse = ",")
query <- list(survey_definition_id<-survey_definition_id, area_id=area_id, species_code=species_code, start_year=start_year, end_year=end_year)
url <- "https://apex.psmfc.org/akfin/data_marts/gap_products/gap_sizecomp?"
httr::content(
httr::GET(url=url, query=query,
add_headers(Authorization = token)),
type = "application/json") %>%
# convert to data frame
dplyr::bind_rows() %>%
dplyr::rename_with(tolower)
}
Start<-Sys.time()
test<-get_gap_sizecomp()
End<-Sys.time()
End-Start
get_gap_specimen<-function(species_code=21740, region="BS") {
# paste(... collapse=",") puts commas between vector elements
region<- paste(region, collapse = ",")
species_code <- paste(species_code, collapse = ",")
query <- list(species_code=species_code, region=region)
url <- "https://apex.psmfc.org/akfin/data_marts/gap_products/gap_specimen?"
httr::content(
httr::GET(url=url, #query=query,
add_headers(Authorization = token)),
type = "application/json") %>%
# convert to data frame
dplyr::bind_rows() %>%
dplyr::rename_with(tolower)
}
Start<-Sys.time()
test<- get_gap_specimen()
get_gap_specimen<-function(species_code=21740, region="BS") {
# paste(... collapse=",") puts commas between vector elements
region<- paste(region, collapse = ",")
species_code <- paste(species_code, collapse = ",")
query <- list(species_code=species_code, region=region)
url <- "https://apex.psmfc.org/akfin/data_marts/gap_products/gap_specimen?"
httr::content(
httr::GET(url=url, query=query,
add_headers(Authorization = token)),
type = "application/json") %>%
# convert to data frame
dplyr::bind_rows() %>%
dplyr::rename_with(tolower)
}
Start<-Sys.time()
test<- get_gap_specimen()
token<-create_token("Callahan_token.txt")
get_gap_specimen<-function(species_code=21740, region="BS") {
# paste(... collapse=",") puts commas between vector elements
region<- paste(region, collapse = ",")
species_code <- paste(species_code, collapse = ",")
query <- list(species_code=species_code, region=region)
url <- "https://apex.psmfc.org/akfin/data_marts/gap_products/gap_specimen?"
httr::content(
httr::GET(url=url, query=query,
add_headers(Authorization = token)),
type = "application/json") %>%
# convert to data frame
dplyr::bind_rows() %>%
dplyr::rename_with(tolower)
}
Start<-Sys.time()
test<- get_gap_specimen()
Start<-Sys.time()
test<- get_gap_specimen()
get_gap_specimen<-function(species_code=21740, region="BS") {
# paste(... collapse=",") puts commas between vector elements
region<- paste(region, collapse = ",")
species_code <- paste(species_code, collapse = ",")
query <- list(species_code=species_code, region=region)
url <- "https://apex.psmfc.org/akfin/data_marts/gap_products/gap_specimen?"
httr::content(
httr::GET(url=url, query=query,
add_headers(Authorization = token)),
type = "application/json") %>%
# convert to data frame
dplyr::bind_rows() %>%
dplyr::rename_with(tolower)
}
Start<-Sys.time()
test<- get_gap_specimen()
get_gap_specimen<-function(species_code=21740, region="GOA") {
# paste(... collapse=",") puts commas between vector elements
region<- paste(region, collapse = ",")
species_code <- paste(species_code, collapse = ",")
query <- list(species_code=species_code, region=region)
url <- "https://apex.psmfc.org/akfin/data_marts/gap_products/gap_specimen?"
httr::content(
httr::GET(url=url, query=query,
add_headers(Authorization = token)),
type = "application/json") %>%
# convert to data frame
dplyr::bind_rows() %>%
dplyr::rename_with(tolower)
}
token<-create_token("Callahan_token.txt")
Start<-Sys.time()
test<- get_gap_specimen()
Start<-Sys.time()
test<-get_gap_cruises()
End<-Sys.time()
End-Start
url <- "https://apex.psmfc.org/akfin/data_marts/gap_products/gap_specimen"
get_gap_specimen<-function(species_code=21740, region="GOA") {
# paste(... collapse=",") puts commas between vector elements
region<- paste(region, collapse = ",")
species_code <- paste(species_code, collapse = ",")
query <- list(species_code=species_code, region=region)
url <- "https://apex.psmfc.org/akfin/data_marts/gap_products/gap_specimen"
httr::content(
httr::GET(url=url, query=query,
add_headers(Authorization = token)),
type = "application/json") %>%
# convert to data frame
dplyr::bind_rows() %>%
dplyr::rename_with(tolower)
}
Start<-Sys.time()
test<- get_gap_specimen()
Start<-Sys.time()
#test<- get_gap_specimen()
test<-httr::content(
httr::GET(url="https://apex.psmfc.org/akfin/data_marts/gap_products/gap_specimen",
add_headers(Authorization = token)),
type = "application/json") %>%
# convert to data frame
dplyr::bind_rows() %>%
dplyr::rename_with(tolower)
Start<-Sys.time()
#test<- get_gap_specimen()
test<-httr::content(
httr::GET(url="https://apex.psmfc.org/akfin/data_marts/gap_products/gap_specimen",
add_headers(Authorization = token)),
type = "application/json") %>%
# convert to data frame
dplyr::bind_rows() %>%
dplyr::rename_with(tolower)
#test<- get_gap_specimen()
test<-httr::content(
httr::GET(url="https://apex.psmfc.org/akfin/data_marts/gap_products/gap_specimen?",
add_headers(Authorization = token)),
type = "application/json") %>%
# convert to data frame
dplyr::bind_rows() %>%
dplyr::rename_with(tolower)
test<- get_gap_area()
get_gap_area<-function() {
url <- "https://apex.psmfc.org/akfin/data_marts/gap_products/gap_area?"
httr::content(
httr::GET(url=url,
add_headers(Authorization = token)),
type = "application/json") %>%
# convert to data frame
dplyr::bind_rows() %>%
dplyr::rename_with(tolower)
}
test<- get_gap_area()
get_gap_specimen<-function(species_code=21740) {
# paste(... collapse=",") puts commas between vector elements
#region<- paste(region, collapse = ",")
species_code <- paste(species_code, collapse = ",")
query <- list(species_code=species_code)
url <- "https://apex.psmfc.org/akfin/data_marts/gap_products/gap_specimen"
httr::content(
httr::GET(url=url, query=query,
add_headers(Authorization = token)),
type = "application/json") %>%
# convert to data frame
dplyr::bind_rows() %>%
dplyr::rename_with(tolower)
}
Start<-Sys.time()
test<- get_gap_specimen()
Start<-Sys.time()
test<- get_gap_specimen()
get_gap_survey_design<-function() {
url <- "https://apex.psmfc.org/akfin/data_marts/gap_products/gap_survey_design?"
httr::content(
httr::GET(url=url,
add_headers(Authorization = token)),
type = "application/json") %>%
# convert to data frame
dplyr::bind_rows() %>%
dplyr::rename_with(tolower)
}
get_gap_survey_design()
get_gap_split_fractions<-function() {
url <- "https://apex.psmfc.org/akfin/data_marts/gap_products/gap_split_fractions?"
httr::content(
httr::GET(url=url,
add_headers(Authorization = token)),
type = "application/json") %>%
# convert to data frame
dplyr::bind_rows() %>%
dplyr::rename_with(tolower)
}
get_gap_split_fractions()
get_gap_stratum_groups<-function() {
url <- "https://apex.psmfc.org/akfin/data_marts/gap_products/gap_stratum_groups?"
httr::content(
httr::GET(url=url,
add_headers(Authorization = token)),
type = "application/json") %>%
# convert to data frame
dplyr::bind_rows() %>%
dplyr::rename_with(tolower)
}
get_gap_stratum_groups()
get_gap_specimen<-function() {
# paste(... collapse=",") puts commas between vector elements
url <- "https://apex.psmfc.org/akfin/data_marts/gap_products/gap_specimen"
httr::content(
httr::GET(url=url,
add_headers(Authorization = token)),
type = "application/json") %>%
# convert to data frame
dplyr::bind_rows() %>%
dplyr::rename_with(tolower)
}
Start<-Sys.time()
test<- get_gap_specimen()
get_gap_specimen<-function(species_code=21740, region="GOA") {
# paste(... collapse=",") puts commas between vector elements
region<- paste(region, collapse = ",")
species_code <- paste(species_code, collapse = ",")
query <- list(species_code=species_code, region=region)
url <- "https://apex.psmfc.org/akfin/data_marts/gap_products/gap_specimen"
httr::content(
httr::GET(url=url, query=query,
add_headers(Authorization = token)),
type = "application/json") %>%
# convert to data frame
dplyr::bind_rows() %>%
dplyr::rename_with(tolower)
}
Start<-Sys.time()
test<- get_gap_specimen()
token<-create_token("Callahan_token.txt")
Start<-Sys.time()
test<- get_gap_specimen()
get_gap_specimen<-function() {
# paste(... collapse=",") puts commas between vector elements
url <- "https://apex.psmfc.org/akfin/data_marts/gap_products/gap_specimen?species_code=21470&region=GOA"
httr::content(
httr::GET(url=url,
add_headers(Authorization = token)),
type = "application/json") %>%
# convert to data frame
dplyr::bind_rows() %>%
dplyr::rename_with(tolower)
}
Start<-Sys.time()
test<- get_gap_specimen()
get_gap_specimen<-function() {
# paste(... collapse=",") puts commas between vector elements
url <- "https://apex.psmfc.org/akfin/data_marts/gap_products/gap_specimen?species_code=21740&region=GOA"
httr::content(
httr::GET(url=url,
add_headers(Authorization = token)),
type = "application/json") %>%
# convert to data frame
dplyr::bind_rows() %>%
dplyr::rename_with(tolower)
}
Start<-Sys.time()
test<- get_gap_specimen()
get_gap_specimen<-function() {
# paste(... collapse=",") puts commas between vector elements
url <- "https://apex.psmfc.org/akfin/data_marts/gap_products/gap_specimen?species_code=21740&region=GOA"
httr::content(
httr::GET(url=url,
add_headers(Authorization = token)),
type = "application/json") %>%
# convert to data frame
dplyr::bind_rows() %>%
dplyr::rename_with(tolower)
}
Start<-Sys.time()
test<- get_gap_specimen()
get_gap_specimen<-function() {
# paste(... collapse=",") puts commas between vector elements
url <- "https://apex.psmfc.org/akfin/data_marts/gap_products/gap_specimen?species_code=21740&region=HWC"
httr::content(
httr::GET(url=url,
add_headers(Authorization = token)),
type = "application/json") %>%
# convert to data frame
dplyr::bind_rows() %>%
dplyr::rename_with(tolower)
}
Start<-Sys.time()
test<- get_gap_specimen()
End<-Sys.time()
End-Start
5000/60
